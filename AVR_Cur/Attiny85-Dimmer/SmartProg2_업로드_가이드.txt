================================================================================
  SmartProg2 업로드 가이드 - ATtiny85 AC Dimmer
  단계별 상세 설명서
================================================================================

[준비물]
─────────────────────────────────────────────────────────────────────────────
✓ SmartProg2 프로그래머
✓ ATtiny85 칩 (DIP-8)
✓ 컴파일된 firmware.hex 파일
✓ USB 케이블 (SmartProg2 연결용)
✓ (선택) ZIF 소켓 또는 브레드보드
─────────────────────────────────────────────────────────────────────────────

[hex 파일 위치]
─────────────────────────────────────────────────────────────────────────────
프로젝트 경로: D:\01_AllData\06_Embedded_Proj\AVR\Attiny85-Dimmer

hex 파일 경로:
.pio\build\attiny85\firmware.hex

전체 경로:
D:\01_AllData\06_Embedded_Proj\AVR\Attiny85-Dimmer\.pio\build\attiny85\firmware.hex
─────────────────────────────────────────────────────────────────────────────

[업로드 순서]
─────────────────────────────────────────────────────────────────────────────

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■ STEP 1: 하드웨어 연결
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1-1. SmartProg2를 PC에 USB로 연결
1-2. ATtiny85 칩을 SmartProg2 ZIF 소켓에 장착
     ⚠️ 주의: 핀1(•표시)을 소켓의 핀1 위치에 맞춤
     
     ATtiny85 핀 배치 확인:
         ┌─────┬─────┐
      1 ─┤• ●  8├─ VCC
      2 ─┤     7├─ 
      3 ─┤     6├─ 
      4 ─┤     5├─ 
         └───────┘
     
1-3. 소켓 레버를 눌러 칩 고정


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■ STEP 2: SmartProg2 소프트웨어 실행
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

2-1. SmartProg2.exe 실행
2-2. 프로그래머 연결 확인
     → 하단 상태바에 "Connected" 또는 연결 상태 표시됨
2-3. Device 메뉴 또는 드롭다운에서 "ATtiny85" 선택
2-4. 칩 인식 확인
     → Device ID 또는 Signature 정보 표시됨


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■ STEP 3: 퓨즈비트 설정 (⚠️ 매우 중요!)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

⚠️ 주의: 퓨즈비트는 반드시 Flash 업로드 전에 먼저 설정하세요!

3-1. "Fuse" 탭 또는 메뉴 클릭
3-2. 현재 퓨즈비트 읽기 (Read Fuse 버튼)
     → 현재 설정값 확인
     
3-3. 퓨즈비트 값 입력:
     ┌─────────────────────────────────────┐
     │ Low Fuse (LFUSE):    E2             │
     │ High Fuse (HFUSE):   DF             │
     │ Extended Fuse (EFUSE): FF           │
     └─────────────────────────────────────┘
     
3-4. 입력값 재확인 (매우 중요!)
     ✓ LFUSE = 0xE2  (8MHz 내부 클럭)
     ✓ HFUSE = 0xDF  (ISP 활성화)
     ✓ EFUSE = 0xFF  (기본값)
     
3-5. "Write Fuse" 버튼 클릭
3-6. 진행 상황 확인 (Progress bar)
3-7. "Success" 또는 성공 메시지 확인

⚠️ 경고 메시지가 나타날 수 있음:
   "Fuse bits will be changed. Continue?"
   → YES 클릭 (정확한 값 입력 확인 후)

3-8. 퓨즈비트 재확인 (Read Fuse로 다시 읽어서 확인)
     → E2, DF, FF가 정확히 설정되었는지 확인


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■ STEP 4: Flash 메모리 업로드
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

4-1. "Flash" 탭 클릭
4-2. "Open" 또는 "Load" 버튼 클릭
4-3. hex 파일 선택
     경로: .pio\build\attiny85\firmware.hex
     
4-4. 파일 로드 확인
     → hex 파일 내용이 프로그램에 표시됨
     → 파일 크기 및 체크섬 정보 확인
     
4-5. (선택) "Auto Erase" 옵션 활성화
     → 쓰기 전 자동으로 칩 지우기
     
4-6. "Write Flash" 또는 "Program" 버튼 클릭
4-7. 진행 상황 확인
     → Progress bar 진행
     → Writing... 표시
     
4-8. 완료 대기 (보통 수 초 소요)
4-9. "Success" 또는 "Programming complete" 메시지 확인


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■ STEP 5: 검증 (Verify)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

5-1. "Verify" 버튼 클릭 (선택사항이지만 권장)
5-2. 칩에 쓰인 내용과 hex 파일 비교
5-3. "Verify OK" 메시지 확인
     → 업로드가 정확히 되었음을 보장


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■ STEP 6: 칩 분리 및 회로 장착
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

6-1. SmartProg2 소프트웨어 종료
6-2. ZIF 소켓 레버를 올려 칩 해제
6-3. ATtiny85 칩을 조심스럽게 제거
6-4. 실제 회로에 장착
     ⚠️ 핀 방향 주의: 핀1(•표시) 확인
     
     최종 핀 연결:
     Pin 1 (RESET) - 10kΩ 풀업 → VCC
     Pin 2 (PB3)   - 가변저항 중간 탭
     Pin 3 (PB4)   - (사용 안함)
     Pin 4 (GND)   - 그라운드
     Pin 5 (PB0)   - MOC3021 → 트라이악
     Pin 6 (PB1)   - (사용 안함)
     Pin 7 (PB2)   - H11AA1 제로크로스
     Pin 8 (VCC)   - 5V 전원

6-5. 전원 인가 및 동작 테스트

─────────────────────────────────────────────────────────────────────────────

[문제 해결 (Troubleshooting)]
─────────────────────────────────────────────────────────────────────────────

□ 문제: 칩이 인식되지 않음
  해결:
  - USB 케이블 재연결
  - 칩 장착 방향 확인 (핀1 위치)
  - 소켓 접촉 확인
  - 다른 USB 포트 시도

□ 문제: 퓨즈비트 쓰기 실패
  해결:
  - VCC 전압 확인 (5V 정상?)
  - 칩 재장착
  - SmartProg2 펌웨어 업데이트 확인

□ 문제: Flash 쓰기 실패
  해결:
  - 칩 지우기 먼저 시도 (Erase Chip)
  - hex 파일 경로 재확인
  - 퓨즈비트 재확인 (SPIEN 활성화되어 있는지)

□ 문제: Verify 실패
  해결:
  - Flash 다시 쓰기
  - 칩 불량 가능성 확인 (다른 칩으로 테스트)

□ 문제: 회로에서 동작하지 않음
  해결:
  - 퓨즈비트 재확인 (LFUSE=E2 맞는지)
  - 5V 전원 공급 확인
  - 제로크로스 신호 확인 (오실로스코프)
  - 핀 연결 재확인
─────────────────────────────────────────────────────────────────────────────

[빠른 체크리스트]
─────────────────────────────────────────────────────────────────────────────
업로드 전:
  □ hex 파일 준비됨 (.pio\build\attiny85\firmware.hex)
  □ SmartProg2 USB 연결됨
  □ ATtiny85 칩 장착됨 (핀1 방향 확인)
  □ Device: ATtiny85 선택됨

퓨즈비트:
  □ LFUSE = E2 (8MHz 내부 클럭)
  □ HFUSE = DF (ISP 활성화)
  □ EFUSE = FF
  □ Write Fuse 성공
  □ Read Fuse로 재확인 완료

Flash:
  □ hex 파일 로드됨
  □ Write Flash 성공
  □ Verify OK (선택사항)

최종:
  □ 칩 분리
  □ 회로 장착 (핀 방향 확인)
  □ 전원 인가
  □ 동작 테스트 완료
─────────────────────────────────────────────────────────────────────────────

[참고사항]
─────────────────────────────────────────────────────────────────────────────
• 퓨즈비트는 한 번만 설정하면 됨 (코드 업데이트 시 재설정 불필요)
• 코드만 수정한 경우: STEP 4만 반복하면 됨
• 여러 칩에 같은 코드 업로드: STEP 3~5 반복
• 업로드 시간: 퓨즈비트 5초 + Flash 10~30초
─────────────────────────────────────────────────────────────────────────────

[안전 주의사항]
─────────────────────────────────────────────────────────────────────────────
⚠️ 정전기 주의: 칩 취급 시 손목 접지 권장
⚠️ 전원 확인: 프로그래밍 중 전원 차단 금지
⚠️ 칩 방향: 핀1(•표시) 위치 반드시 확인
⚠️ 퓨즈비트: 잘못된 설정 시 칩 복구 어려울 수 있음
─────────────────────────────────────────────────────────────────────────────

작성일: 2025-12-18
프로젝트: ATtiny85 AC Dimmer (U2008 대체)
버전: 1.0

================================================================================
이 가이드를 따라하면 안전하고 정확하게 ATtiny85에 코드를 업로드할 수 있습니다.
================================================================================
